<img width="397" height="456" alt="image" src="https://github.com/user-attachments/assets/b40c2461-17e1-4cb6-8dc1-f68628ca5782" /><img width="426" height="206" alt="image" src="https://github.com/user-attachments/assets/62f79856-9cd9-45ac-aa46-b1578712bd38" /><img width="426" height="206" alt="image" src="https://github.com/user-attachments/assets/ad084d4c-303a-4db5-baa7-acceba698642" /><img width="461" height="146" alt="image" src="https://github.com/user-attachments/assets/d0cce1d8-189a-47fe-b59a-67739fd5741c" /><img width="328" height="172" alt="image" src="https://github.com/user-attachments/assets/c6ee02ba-3039-4b14-8be7-4bd2591c63ab" /><h1 align="center"> Malware Analysis Lab Setup </h1>



# INSTALLATION & SETUP

## HYPERVISOR INSTALLATION 
First go to: 




Or do following this video: 


---


# INSTALLINSTAL WINDOWS 10
Do following this: https://www.youtube.com/watch?v=WjgDFcKTo80


- After setup it on VMware:
[How To Setup Windows 10 on VMware.pdf](https://github.com/user-attachments/files/25050799/How.To.Setup.Windows.10.on.VMware.pdf)

## Setup Windows 10
FlareVM-Windows 10

<img width="1918" height="1078" alt="image" src="https://github.com/user-attachments/assets/80fc05a1-3b35-4d7c-b6c8-bb3b38de3f64" />


---



# SETUP LAB 
[Malware Labs Setup.pdf](https://github.com/user-attachments/files/25050895/Malware.Labs.Setup.pdf)


In this after we 


## Setup Malware Lab:



### Setup Flare-VM
first click on `Create a New Virtual Machine`:
<img width="1918" height="1078" alt="image" src="https://github.com/user-attachments/assets/52b2835c-5c9f-4182-aa30-63db4e508734" />

<img width="506" height="527" alt="image" src="https://github.com/user-attachments/assets/ee9325de-2506-41ed-a9d1-71cc4ac365e1" />

<img width="500" height="528" alt="image" src="https://github.com/user-attachments/assets/d4ccf9c9-fcd4-4dee-a4cc-e302ba4c1016" />

<img width="493" height="526" alt="image" src="https://github.com/user-attachments/assets/72c25077-718f-438c-bb2d-7f6af59c3e34" />


<img width="495" height="528" alt="image" src="https://github.com/user-attachments/assets/0c130863-d777-4cd7-a4b4-8477ca60419e" />

<img width="497" height="530" alt="image" src="https://github.com/user-attachments/assets/fcfb8872-a3be-4a98-902e-b444297542ab" />

<img width="496" height="527" alt="image" src="https://github.com/user-attachments/assets/1a24bca0-0bdf-432f-89b5-837aa4406323" />

<img width="883" height="470" alt="image" src="https://github.com/user-attachments/assets/74ad8a7e-27cb-4a4c-b360-cf4b9b4eaa9e" />

<img width="1157" height="832" alt="image" src="https://github.com/user-attachments/assets/544d06af-bdec-4c47-b8fe-b5c86d595deb" />

- In this first we need to choose `NAT`, cause in this when we install ``flare VM`` we will install it on powershell and need internet:
<img width="883" height="876" alt="image" src="https://github.com/user-attachments/assets/d4c0892f-96d4-4d3f-bec8-bc478dde5bd3" />

- After click on `Finished`:
<img width="495" height="523" alt="image" src="https://github.com/user-attachments/assets/cbd3bdc3-8e50-4cda-b671-702ee704125d" />

<img width="1918" height="1078" alt="image" src="https://github.com/user-attachments/assets/ce25b363-5888-4ce7-ac44-3a1f1faf616b" />

- And in this we need to press any key:
<img width="1919" height="750" alt="image" src="https://github.com/user-attachments/assets/4a6ad3f6-f6ee-44f5-8769-efd83e4cfdd4" />


<img width="613" height="458" alt="image" src="https://github.com/user-attachments/assets/c0c35334-a8bd-4186-b619-4bfdc02c275d" />


<img width="622" height="458" alt="image" src="https://github.com/user-attachments/assets/ff328704-d022-442e-8934-34f7cc705f24" />


<img width="638" height="482" alt="image" src="https://github.com/user-attachments/assets/e03f63b8-845d-49ee-ae08-72d033d07079" />


<img width="636" height="482" alt="image" src="https://github.com/user-attachments/assets/0b48a2d1-f009-4dae-b333-3ff2f6401d72" />


<img width="638" height="481" alt="image" src="https://github.com/user-attachments/assets/b7fd7501-21fb-4572-9292-7fb75b7c8793" />


<img width="637" height="477" alt="image" src="https://github.com/user-attachments/assets/b88ca626-8e70-45e7-a992-d8b88654b3eb" />


<img width="635" height="477" alt="image" src="https://github.com/user-attachments/assets/d210cfce-064f-4147-9508-7d37bb22c4d3" />


<img width="641" height="482" alt="image" src="https://github.com/user-attachments/assets/23d93708-2aed-4904-bf46-0871ce97554c" />


<img width="511" height="206" alt="image" src="https://github.com/user-attachments/assets/2bbf3607-596d-4cb8-b6fa-408780548639" />


<img width="636" height="481" alt="image" src="https://github.com/user-attachments/assets/8725a58f-e54b-4e4f-89bc-a5dca135af82" />

Now it start `Installing` and wait a few minute:
<img width="1028" height="775" alt="image" src="https://github.com/user-attachments/assets/3ab21395-e299-42dc-93a9-ca3de5ac2c31" />

After it installed it will show this:
<img width="767" height="640" alt="image" src="https://github.com/user-attachments/assets/4747643d-4da2-49b1-a154-77754dd26b6f" />

- After wait a few minute:

<img width="1017" height="673" alt="image" src="https://github.com/user-attachments/assets/29e2f9bb-3843-4c85-a97e-f50f58f9cfce" />


<img width="1012" height="668" alt="image" src="https://github.com/user-attachments/assets/d2677aa3-097d-4ce1-baf8-f911658ea1b1" />


<img width="987" height="632" alt="image" src="https://github.com/user-attachments/assets/4e0a8fdd-2795-4ef6-9ec6-a9d5899f0cb4" />


<img width="916" height="597" alt="image" src="https://github.com/user-attachments/assets/935be398-16a1-4b02-860b-d1d6054f210a" />



<img width="1012" height="648" alt="image" src="https://github.com/user-attachments/assets/ae8586d4-accb-4a24-b875-6470627e4adb" />


<img width="1000" height="620" alt="image" src="https://github.com/user-attachments/assets/8138e95e-53ff-4335-85fd-174c5288a282" />


<img width="1006" height="641" alt="image" src="https://github.com/user-attachments/assets/c1fbc714-86c6-45fa-a5f5-5e66088317be" />



<img width="995" height="630" alt="image" src="https://github.com/user-attachments/assets/f5ac0442-eca1-41f0-bb12-bcc11cabc9a7" />


<img width="980" height="625" alt="image" src="https://github.com/user-attachments/assets/d108ba7c-996d-4b2c-b55c-669a72951b7f" />


<img width="974" height="622" alt="image" src="https://github.com/user-attachments/assets/909b5421-035d-4bb2-9f4b-23f024a4bd3d" />


<img width="995" height="621" alt="image" src="https://github.com/user-attachments/assets/c1ec6444-272b-4441-b5bb-408c6da6529c" />


<img width="993" height="620" alt="image" src="https://github.com/user-attachments/assets/f1767511-8488-4b50-8eb5-31816977adc5" />



<img width="997" height="669" alt="image" src="https://github.com/user-attachments/assets/ec45dcec-5583-4e77-a0d6-7de3518f99b4" />

- Click `Skip`:
<img width="997" height="651" alt="image" src="https://github.com/user-attachments/assets/fb2c4fdc-7bb0-449c-8a8b-f125fe4b2712" />


<img width="1005" height="651" alt="image" src="https://github.com/user-attachments/assets/1e037c1c-05be-4721-812a-6593cf672c67" />

- Now we got success:
<img width="1592" height="563" alt="image" src="https://github.com/user-attachments/assets/dd314427-17cc-4d19-910e-3fb46835c532" />


- Now we got a windows:
<img width="1018" height="770" alt="image" src="https://github.com/user-attachments/assets/c2939c97-6e74-4691-bd71-4140c5d7475b" />

- After go to `Virus & Threat Protection`:
<img width="763" height="685" alt="image" src="https://github.com/user-attachments/assets/fd6e59f6-6954-4322-b0b7-c6674c51d5d4" />

- And then click on `Manage Settings`:
<img width="1020" height="768" alt="image" src="https://github.com/user-attachments/assets/1e612b07-a717-413c-bea2-f85ca734e2ed" />

- After take it to `Off` all:
<img width="1020" height="727" alt="image" src="https://github.com/user-attachments/assets/f1706977-61ac-4ffc-bfff-e22ae0f5ec45" />


- After press `Ctrl + R` -> Type `gpedit.msc`:
<img width="403" height="202" alt="image" src="https://github.com/user-attachments/assets/50547a44-47d8-4ba8-a9dd-b0f91c7cc7a3" />

- After go to: `Computer Configuration` -> `Administrative Templates` -> `Windows Components` -> `Windows Update`:
<img width="1027" height="727" alt="image" src="https://github.com/user-attachments/assets/78b87d92-8702-43ac-bde1-dc49caf35ec4" />

<img width="1023" height="726" alt="image" src="https://github.com/user-attachments/assets/2d866c45-9bc4-4a79-990d-7717dcec38f4" />

- After `Double-Click` on it:
<img width="684" height="632" alt="image" src="https://github.com/user-attachments/assets/3d4081d5-3df2-4683-9711-cd400a345878" />

- Now we see it `Disable`:
<img width="1021" height="726" alt="image" src="https://github.com/user-attachments/assets/17045433-a688-4f25-bcf5-bf69f8a51aa4" />


- After go to: `Computer Configuration` -> `Administrative Templates` -> `Windows Components` -> `Microsoft Defender Antivirus`:
<img width="1027" height="727" alt="image" src="https://github.com/user-attachments/assets/78b87d92-8702-43ac-bde1-dc49caf35ec4" />

- After `Double-Click` on it:
<img width="1023" height="722" alt="image" src="https://github.com/user-attachments/assets/54c022d7-7f50-4846-a2b9-795355494e3d" />

<img width="679" height="632" alt="image" src="https://github.com/user-attachments/assets/1338c44a-aec7-4200-9b6f-232d67d5a1a1" />

- Now we see it `Enable`:
<img width="1022" height="722" alt="image" src="https://github.com/user-attachments/assets/7d759d32-478c-4177-bac9-10494900e231" />

- After `Double-Click` on it:
<img width="1017" height="710" alt="image" src="https://github.com/user-attachments/assets/4d645df0-045e-4c6d-b736-ac9c12327338" />

<img width="687" height="632" alt="image" src="https://github.com/user-attachments/assets/49ac8c5b-eec6-4bf5-9adf-7ce8ba0d9785" />

- Now we see this:
<img width="1026" height="730" alt="image" src="https://github.com/user-attachments/assets/f72804d2-82ee-4c31-8c4b-5a5e211b67d5" />

- After `Restart` this:
<img width="1026" height="774" alt="image" src="https://github.com/user-attachments/assets/a32c86e1-6d1d-4343-9e56-f642f50654fd" />

- After open `PowerShell`, just press `Ctrl + S` -> After search `Powershell`:
<img width="1023" height="775" alt="image" src="https://github.com/user-attachments/assets/3e522a41-d621-45df-bf7f-0b795e723bf4" />

<img width="457" height="317" alt="image" src="https://github.com/user-attachments/assets/909c2dd0-79bd-4b03-82a2-2f1f77bcf008" />

- After go to our `Desktop` folder, but first in this I want to open normal `Powershell` and type:
````
cd Desktop
pwd
````
<img width="328" height="172" alt="image" src="https://github.com/user-attachments/assets/b7d059cd-d01b-49ad-bb59-998b53c34f6d" />

- After back to our `Powershell Administrator`:
````
cd C:\Users\k4n0ng\Desktop
````
<img width="461" height="146" alt="image" src="https://github.com/user-attachments/assets/ddac3945-e2e3-468d-8121-8ffbf64002c9" />


#### Setup FlareeVM
First go to: https://github.com/mandiant/flare-vm
<img width="991" height="687" alt="image" src="https://github.com/user-attachments/assets/7e74efd5-0800-41d5-9bec-e6131bcb23a0" />

- After back to our `Powershell Administrator` and type this:
````
(New-Object net.webclient).DownloadFile('https://raw.githubusercontent.com/mandiant/flarevm/main/install.ps1',"$([Environment]::GetFolderPath("Desktop"))\install.ps1")
````
<img width="1026" height="149" alt="image" src="https://github.com/user-attachments/assets/7c77416a-d4e1-4f3f-8b74-75c32b0f7c13" />

- After we will see file `Install` on our Desktop:
<img width="1021" height="765" alt="image" src="https://github.com/user-attachments/assets/37e1be69-fa98-400e-83db-ccbf9e623d77" />

- After Unlock the installation script:
````
Unblock-File .\install.ps1
````
<img width="530" height="131" alt="image" src="https://github.com/user-attachments/assets/20a8cfed-5d6e-413c-9d10-c04eb7e3abcb" />


- And then `Enable Script Execute`:
````
Set-ExecutionPolicy Unrestricted -Force
````
<img width="528" height="125" alt="image" src="https://github.com/user-attachments/assets/f64945bf-9e46-4c80-9e6e-3cb8ea778f91" />


- After `execute` command:
````
.\install.ps1
````
<img width="1030" height="726" alt="image" src="https://github.com/user-attachments/assets/4cfe2424-0fe9-45cc-b14a-9b74dabb4411" />

- In this we need to input our password `Windows` for use flareVM:
<img width="1013" height="488" alt="image" src="https://github.com/user-attachments/assets/d3cd9b0c-08b8-40d7-99fe-05e742d4610d" />

- Now it start installation, and wait a few minute:
<img width="1020" height="738" alt="image" src="https://github.com/user-attachments/assets/e647abfc-7bf0-4e70-9044-bd8fc5af11d8" />

- After click `Continue`, and don't change any thing:
<img width="748" height="378" alt="image" src="https://github.com/user-attachments/assets/8ef6d1f5-9b0a-49f8-873a-3c71f5ed211d" />

- After we see like this just press `Tab + Enter`:
<img width="1104" height="811" alt="image" src="https://github.com/user-attachments/assets/483a0d85-ed2a-4884-a787-d889c4828b82" />

- After it will work and install, and wait afew minute:
<img width="1014" height="773" alt="image" src="https://github.com/user-attachments/assets/9ed88b08-c645-4ac3-834d-84f6f3f6a59f" />

- After wait a few minute it will `Restart`:
<img width="965" height="698" alt="image" src="https://github.com/user-attachments/assets/0f80e8d1-7ac0-4312-b174-8d0a54cf51fc" />

- After `Restart` it will install:
<img width="1025" height="764" alt="image" src="https://github.com/user-attachments/assets/99ca2c84-ffce-4919-9ece-3d396c8ced6b" />

- After we wait a few minutes, now we got a new `Flare-VM`:
<img width="1003" height="775" alt="image" src="https://github.com/user-attachments/assets/1a01a4fb-cb60-445a-99ef-c578a3f3e1a9" />


---




















## INSTALLATION REMnux:
- Go to: https://docs.remnux.org/install-distro/get-virtual-appliance

<img width="1855" height="1017" alt="image" src="https://github.com/user-attachments/assets/eeb28e93-761d-47be-9469-fd42531626d3" />

- IN this if we use `VirtulaBox` then go to `VirtualBox OVA` and click download, but if we use others VirtualMachine and then click `Download the general OVA file`.

- After finished download -> go to `File Explorer`:
<img width="764" height="241" alt="image" src="https://github.com/user-attachments/assets/081f6e42-4208-41d6-9aa3-e5239241c4ca" />

- But in this download it befor.

- After back to our **VMWare** click `File` -> select `Open...`:
<img width="1372" height="638" alt="image" src="https://github.com/user-attachments/assets/4ce1491a-45c8-41a2-ba8c-3cceeb90d010" />

<img width="1145" height="781" alt="image" src="https://github.com/user-attachments/assets/b2058fc7-e6c9-4a97-b070-9d5f92ca19ee" />

<img width="477" height="531" alt="image" src="https://github.com/user-attachments/assets/608f1947-3bc2-47b6-b953-19c5b085a022" />

Now it was setup, and wait a few minute:
<img width="721" height="443" alt="image" src="https://github.com/user-attachments/assets/6680172e-7585-4f96-9a81-8096a9e326c3" />

- Now we got success:
<img width="1610" height="794" alt="image" src="https://github.com/user-attachments/assets/5db32caa-9205-4b06-9f50-4722d2a870f0" />


---


### Configuration

#### On REMnux:
<img width="1572" height="855" alt="image" src="https://github.com/user-attachments/assets/88166442-8af2-4363-9d1b-06a8f6ba181a" />

<img width="886" height="900" alt="image" src="https://github.com/user-attachments/assets/45791fbf-e47c-4a09-b33f-3ca3a2c8b9dc" />

#### On FlareVM
- Firts `PowerOff` our flare machine, And then click on `Adit Virtual Machine setting`:
<img width="1566" height="843" alt="image" src="https://github.com/user-attachments/assets/e0969d98-11fc-459c-b870-7d5db78c30b1" />

<img width="881" height="897" alt="image" src="https://github.com/user-attachments/assets/836b4222-1195-48ff-b7cd-ba85de3a7456" />

- Now we finished setup configure.

- After we finished configuration both, then `Power On` both of it.

- But now on my **Flare-VM** now it so small screen, then make it to full screen:
<img width="1919" height="1020" alt="image" src="https://github.com/user-attachments/assets/96a38f99-4427-48f7-9a6c-b858255cee86" />

- After click on `Install VMware Tools`:
<img width="1918" height="967" alt="image" src="https://github.com/user-attachments/assets/57e791a4-6e4f-4a82-a937-b8cc505d6d7d" />

- After `Double-Click` on `DVD Drive (D:) VMware Tools`:
<img width="1027" height="782" alt="image" src="https://github.com/user-attachments/assets/07c10185-55bf-46d0-b344-6bb628e76cee" />

- And then click `Ok`:
<img width="452" height="330" alt="image" src="https://github.com/user-attachments/assets/83bd6f6e-acce-454a-9224-f66622ef4c6e" />

<img width="495" height="391" alt="image" src="https://github.com/user-attachments/assets/46a2ed64-11d0-4c36-94b0-eb47aa254730" />

<img width="495" height="391" alt="image" src="https://github.com/user-attachments/assets/b0bde0b9-5083-4e6c-a3d1-037c731ed48a" />

<img width="491" height="396" alt="image" src="https://github.com/user-attachments/assets/800da05e-dde6-4bbc-91a2-30922b9f1aea" />

- After wait a few minutes it will finished download and see full screen:
<img width="1918" height="1028" alt="image" src="https://github.com/user-attachments/assets/3816f341-347f-4c23-a84f-cd28aa3b63ca" />

- Now we see it now full screen, and click `Finish`, and after click `Yes` to restart:
<img width="367" height="176" alt="image" src="https://github.com/user-attachments/assets/3dacc527-f008-4f29-a9d2-540c9d083389" />

- After see login we see it full screen:
<img width="1917" height="1076" alt="image" src="https://github.com/user-attachments/assets/b27bf43a-d0ea-4df1-bd19-c553f5c36a29" />



---


### Verify both machine:

#### Check IP
- On **REMnux**:
````
ifconfig
````
<img width="783" height="343" alt="image" src="https://github.com/user-attachments/assets/ea6768d5-69d0-44f3-938a-ce4e8473f2f8" />

Now i see my IP of `REMnux` is `192.169.183.130`.


- ON **Flare-VM**:
````
ipconfig
````
<img width="527" height="230" alt="image" src="https://github.com/user-attachments/assets/477d8c2f-a9af-4f14-9519-dbe3245354b6" />

Now we see on my `Flare-VM` have IP `1-2.168.183.129`.



#### Use ping command:

- On **Flare-VM**:
````
ping 192.168.183.130
````
<img width="426" height="206" alt="image" src="https://github.com/user-attachments/assets/48ede3c1-c4fb-4a57-96e2-74528e1a7e9c" />

Now my machine (FlareVM) now know my ``REMnux``.


- ON my **REMnux**:
````
ping 192.168.183.129
````
<img width="659" height="264" alt="image" src="https://github.com/user-attachments/assets/6d076319-ff05-4bf6-949d-9372195b270d" />

Now my machine (REMnux) now know my ``FlareVM``.


#### Config **inetsim**:
````
sudo nano /etc/inetsim/inetsim.conf
````
<img width="1167" height="816" alt="image" src="https://github.com/user-attachments/assets/5985a276-a4e4-44a4-acf0-2747855da792" />

- In this uncommand it:
<img width="606" height="762" alt="image" src="https://github.com/user-attachments/assets/446dec44-81b9-42d2-b464-e063071672ad" />

- After scroll down, and thsi change to:
````
service_bind_address    192.168.183.130
````
<img width="514" height="431" alt="image" src="https://github.com/user-attachments/assets/adfd90d0-ba02-4ce5-a3a9-2df1aac28948" />

- `192.168.183.130`: IS my ip `REMnux`.

- After scroll down to find `Service DNS`, and `dns_bind_port`:
````
ddns_bind_port           53
````
<img width="558" height="286" alt="image" src="https://github.com/user-attachments/assets/e5ddf1e6-70a0-461a-9826-d7202f2a536d" />

- After on `dns_deault_ip`:
````
dns_default_ip          192.168.183.130
````
<img width="438" height="220" alt="image" src="https://github.com/user-attachments/assets/cd7d4b2d-0ede-4092-902b-451c0089fb4b" />

- `192.168.183.130`: IS my ip `REMnux`.

- After go to find `Service HTTP`:
````
http_bind_port          80
````
<img width="565" height="492" alt="image" src="https://github.com/user-attachments/assets/301df3f7-87fb-45a6-be55-e57c7f489339" />

- After config it all and then save it, press `Ctrl + O` -> `Enter` -> `Ctrl + X`. 

- After open **Internet Simulate**:
````
inetsim
````
<img width="910" height="517" alt="image" src="https://github.com/user-attachments/assets/de49c7b6-436c-4a2b-a4ab-6ef020197342" />

- After go back to **Flare-VM**, `Right-Click` on our `Internet or wifi` -> click `open Network Internet Setting`:
<img width="1918" height="997" alt="image" src="https://github.com/user-attachments/assets/78e3610a-ecc0-45f7-9dba-7ab6e050e356" />

<img width="1023" height="800" alt="image" src="https://github.com/user-attachments/assets/56104276-1638-4e19-8e8b-cc58c85cce0e" />

<img width="1127" height="592" alt="image" src="https://github.com/user-attachments/assets/20dd4f91-bd80-4a82-8be4-f0c86bcfb32b" />

- `Double-Click` on it:
<img width="360" height="468" alt="image" src="https://github.com/user-attachments/assets/51e1d343-b754-44c0-acd8-6bdb2ff128a8" />

- After input the **REMnux** IP:
<img width="397" height="456" alt="image" src="https://github.com/user-attachments/assets/3fcfbba8-d70e-4143-81a0-a8e37e7873b1" />

<img width="362" height="467" alt="image" src="https://github.com/user-attachments/assets/015d4d2c-11b4-46a5-bdea-5803ce768797" />


- After take snapshots:
<img width="1918" height="1051" alt="image" src="https://github.com/user-attachments/assets/6e65bf83-d504-4d28-bf3a-996b6a23378a" />

<img width="415" height="285" alt="image" src="https://github.com/user-attachments/assets/6a7935b6-db55-46fe-bace-eca5cfff8169" />

Now it now take snapshot and wait until it full `100%`:
<img width="1921" height="1083" alt="image" src="https://github.com/user-attachments/assets/36667739-68ea-4225-aaca-1ace2ac42ff1" />


#### After on **REMnux**:
First after we `Power On` our `REMnux` -> After take snapshot:
<img width="1918" height="1078" alt="image" src="https://github.com/user-attachments/assets/8a9de058-076d-42a9-a51b-449eebdd923a" />

- After just input name on our snapshot:
<img width="418" height="290" alt="image" src="https://github.com/user-attachments/assets/36292374-969d-4186-93ea-d10b8b7e925b" />

Now it start to take snapshot:
<img width="1921" height="1083" alt="image" src="https://github.com/user-attachments/assets/3e6c7cae-be57-403a-a03d-a6c0acc4fe4e" />

- Now we can snapshots.

- After verify it:
````
nslookup google.com
````
<img width="606" height="230" alt="image" src="https://github.com/user-attachments/assets/f809f6e6-0cff-4eaf-bcf2-f60ef423dde4" />

- But now it not work.

- After I use python script:
````
sudo pkill inetsim
````
<img width="419" height="144" alt="image" src="https://github.com/user-attachments/assets/48d00d29-b8ff-4797-93fa-3d0e46a290d0" />


````
sudo nano dns.py
````
````
#!/usr/bin/env python3
import socket, struct, sys
ip = sys.argv[1] if len(sys.argv)>1 else '192.168.183.130'
sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sock.bind(('0.0.0.0', 53))
print(f"[*] DNS server running on 0.0.0.0:53 â†’ responding with {ip}")
while True:
    query, addr = sock.recvfrom(512)
    txid = query[:2]
    flags = b'\x81\x80'  # Standard query response, no error
    qdcount = b'\x00\x01'
    ancount = b'\x00\x01'
    nscount = b'\x00\x00'
    arcount = b'\x00\x00'
    # Extract queried domain (simplified)
    qname_end = query.find(b'\x00', 12)
    question = query[12:qname_end+5] if qname_end != -1 else b''
    answer = b'\xc0\x0c\x00\x01\x00\x01\x00\x00\x00\x3c\x00\x04' + socket.inet_aton(ip)
    sock.sendto(txid + flags + qdcount + ancount + nscount + arcount + question + answer, addr)
````
<img width="1086" height="430" alt="image" src="https://github.com/user-attachments/assets/04d74824-9b80-4114-b4e6-db5644b72188" />

- To save it press `Ctrl + O` -> `Enter` -> `Ctrl + X`.

````
chmod +x dns.py
````
<img width="636" height="127" alt="image" src="https://github.com/user-attachments/assets/e18fa768-96ee-4840-89a3-f9ccdc131929" />

- Run it:
````
sudo ./dns.py 192.168.183.130
````
<img width="666" height="179" alt="image" src="https://github.com/user-attachments/assets/e8cee44e-cfb1-42d5-9667-01cbd0df86ed" />

- Now we got successful:
<img width="461" height="253" alt="image" src="https://github.com/user-attachments/assets/94ec5034-df3f-4a5b-9ee8-8538ec71e68b" />

<img width="971" height="683" alt="image" src="https://github.com/user-attachments/assets/774d85e5-ac51-4b45-a15d-393ae450ae24" />

- IT error.

- To fix it:

First on `Terminal 1` on REMnux:
````
sudo inetsim
````
<img width="707" height="487" alt="image" src="https://github.com/user-attachments/assets/b65144c4-1f73-4686-ae61-133ce1b4a838" />


Second on `Terminal 2` on REMnux:
````
sudo dns.py
````
<img width="748" height="119" alt="image" src="https://github.com/user-attachments/assets/b9a623cc-3c96-45e6-ac43-3d743e974f3c" />

- After back to our **FlareVM**:
````
curl http://malware-c2.com
````
<img width="882" height="301" alt="image" src="https://github.com/user-attachments/assets/398bdd60-11e6-4733-867d-c3f87188e0a2" />

- Test with others:
````
curl http://test.com
````
<img width="837" height="566" alt="image" src="https://github.com/user-attachments/assets/5eca4ceb-c0a3-4f17-9129-48d929d7fcd9" />


- Now we got successful.



---

<h2> Completed - Malware Labv Setup </h2>

<h2 align="center"> 
  &copy; 2026 Nin Kanong (<a href="https://github.com/Nin-Kanong/pentest-writeups">@k4n0ng</a>). All rights reserved.
</h2>

